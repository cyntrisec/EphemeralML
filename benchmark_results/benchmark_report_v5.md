# EphemeralML Benchmark Report

**Model:** MiniLM-L6-v2
**Hardware:** m6i.xlarge
**Commit:** 6a0e5f9
**Timestamp:** 1769977102Z
**Iterations:** 100

## Stage Timing

| Stage | Bare Metal | Enclave | Overhead |
|-------|-----------|---------|----------|
| Attestation | N/A | 276.78ms | N/A (enclave-only) |
| KMS Key Release | N/A | 78.87ms | N/A (enclave-only) |
| Model Fetch | 37.06ms | 6602.47ms | +17715.6% |
| Model Decrypt | 111.81ms | 101.27ms | -9.4% |
| Model Load | 43.01ms | 40.20ms | -6.5% |
| Tokenizer Setup | 18.86ms | 25.21ms | +33.7% |
| Cold Start Total | 210.84ms | 7132.33ms | +3282.8% |

## Inference Latency

| Percentile | Bare Metal | Enclave | Overhead |
|-----------|-----------|---------|----------|
| Mean | 81.32ms | 93.08ms | +14.5% |
| P50 | 81.16ms | 92.85ms | +14.4% |
| P95 | 83.12ms | 94.95ms | +14.2% |
| P99 | 83.56ms | 95.29ms | +14.0% |
| Min | 79.63ms | 91.07ms | +14.4% |
| Max | 83.89ms | 95.30ms | +13.6% |
| Throughput | 12.3 inf/s | 10.7 inf/s | -12.7% |

## Memory Usage

| Metric | Bare Metal | Enclave | Overhead |
|--------|-----------|---------|----------|
| Peak RSS | 535.0 MB | 1064.3 MB | +98.9% |
| Model Size | 86.7 MB | 86.7 MB | - |

## VSock Communication (Enclave Only)

| Payload Size | RTT |
|-------------|-----|
| 64 bytes | 0.17ms |
| 1 KB | 0.14ms |
| 64 KB | 0.41ms |
| 1 MB | 4.56ms |
| **Upload Throughput** | **219.4 MB/s** |

## Output Quality Verification

**Reference text:** "What is the capital of France?"
**Embedding dimension:** 384
**Cosine similarity (first 8 dims):** 1.000000

Enclave produces **identical** embeddings to bare metal (cosine sim > 0.9999).

## Cost Analysis

**Instance:** m6i.xlarge @ $0.192/hr (on-demand, us-east-1)

| Metric | Bare Metal | Enclave |
|--------|-----------|---------|
| Inferences/hour | 44,280 | 38,664 |
| Cost per 1K inferences | $0.0043 | $0.0050 |
| Cost per 1M inferences | $4.34 | $4.97 |
| Enclave cost multiplier | â€” | 1.15x |

## Summary

- **Inference overhead:** +14.5% (enclave vs bare metal)
- **Memory overhead:** +98.9% peak RSS
- **Attestation cost:** 276.8ms (one-time per session)
- **Cost per 1M inferences:** $4.97 (enclave on m6i.xlarge)

---
*Generated by `scripts/benchmark_report.py`*

## Security Primitives Overhead (Tier 4)

### HPKE Session Setup

| Operation | Mean | P50 | P95 | P99 |
|-----------|------|-----|-----|-----|
| Full session setup (both sides) | 0.1005ms | 0.0995ms | 0.0999ms | 0.1261ms |
| X25519 keypair generation | 0.0167ms | 0.0163ms | 0.0165ms | 0.0246ms |

### HPKE Encrypt/Decrypt Latency

| Payload | Encrypt Mean | Decrypt Mean | Total |
|---------|-------------|-------------|-------|
| 64B | 0.0020ms | 0.0019ms | 0.0039ms |
| 1KB | 0.0027ms | 0.0026ms | 0.0053ms |
| 64KB | 0.0526ms | 0.0698ms | 0.1224ms |
| 1MB | 0.9189ms | 0.9740ms | 1.8929ms |

### Receipt Generation & Verification

| Operation | Mean | P50 | P95 | P99 |
|-----------|------|-----|-----|-----|
| Ed25519 keypair generation | 0.0172ms | 0.0171ms | 0.0172ms | 0.0188ms |
| Receipt sign (CBOR + Ed25519) | 0.0221ms | 0.0220ms | 0.0222ms | 0.0229ms |
| Receipt verify | 0.0458ms | 0.0454ms | 0.0460ms | 0.0538ms |
| CBOR canonical encoding (568B) | 0.0012ms | 0.0012ms | 0.0013ms | 0.0013ms |

### Per-Inference Crypto Budget (1KB payload)

| Component | Cost |
|-----------|------|
| HPKE decrypt (request) | 0.0026ms |
| Receipt sign | 0.0221ms |
| HPKE encrypt (response) | 0.0027ms |
| **Total crypto overhead** | **0.0274ms** |
